<aura:component controller="TTI_ServiceRequestController">
    
    <aura:attribute name="Service_Request_Case" type="Case"/>
    <aura:attribute name="TaskList" type="List"/>
    <aura:method name="populateTaskInfo" action="{!c.populateTaskInfoMethod}"/>
    <aura:attribute name="selectedTaskId" type="string"/>
    
    <div class="demo-only slds-hide" aura:id="modal">
        <section role="dialog" tabindex="-1" aria-label="Meaningful description of the modal content" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header slds-modal__header_empty">
                    <button onclick="{!c.closeModal}"
                            class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                        <lightning:icon iconName="utility:close"/>
                    </button>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                	<force:recordEdit aura:id="edit" recordId="{!v.selectedTaskId}"/>    
                </div>
                
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    
    <div class="slds-table_edit_container slds-is-relative" aura:id="TaskTableId">
        <legend class="slds-form-element__label slds-text-heading_medium slds-m-top_medium 
                       slds-m-bottom_medium" 
                onclick="{!c.toggleSection}"
                style="background:#f9f9fa;cursor:pointer;width:100%">
            <div class="slds-float--left ">
                <lightning:icon aura:id="section" iconName="utility:chevronright" size="x-small" alternativeText="Indicates add"/>
                <lightning:icon class="slds-hide" aura:id="section" iconName="utility:chevrondown" size="x-small" alternativeText="Indicates dash"/>
            </div>
            <span class="slds-m-left_medium">
                <b><u>More Information Required</u></b>
            </span>
        </legend>
        
        <table aura:id="section" class="slds-hide slds-table slds-table_bordered slds-table_resizable-cols slds-table_fixed-layout slds-no-cell-focus slds-table_edit" role="grid" style="width: 66.75rem;">
            <thead>
                <tr class="slds-line-height_reset">
                    <th aria-sort="none" class="slds-is-sortable slds-is-resizable" aria-label="Order Nbr" scope="col">
                        <a class="slds-th__action slds-text-link_reset" href="javascript:void(0);" role="button" tabindex="-1">
                            <span class="slds-truncate" title="Subject">
                                <b>Subject</b>
                            </span>
                        </a>
                    </th>
                    <th aria-sort="none" class="slds-is-sortable slds-is-resizable" aria-label="Order Nbr" scope="col">
                        <a class="slds-th__action slds-text-link_reset" href="javascript:void(0);" role="button" tabindex="-1">
                            <span class="slds-truncate" title="Due Date">
                                <b>Due Date</b>
                            </span>
                        </a>
                    </th>
                    <th aria-sort="none" class="slds-is-sortable slds-is-resizable" aria-label="Order Nbr" scope="col">
                        <a class="slds-th__action slds-text-link_reset" href="javascript:void(0);" role="button" tabindex="-1">
                            <span class="slds-truncate" title="Order Nbr">
                                <b>Assigned To</b>
                            </span>
                        </a>
                    </th>
                    <th aria-sort="none" class="slds-is-sortable slds-is-resizable" aria-label="Order Nbr" scope="col">
                        <a class="slds-th__action slds-text-link_reset" href="javascript:void(0);" role="button" tabindex="-1">
                            <span class="slds-truncate" title="Order Nbr">
                                
                            </span>
                        </a>
                    </th>
                    
                </tr>
                
            </thead>
            <tbody>
                <aura:iteration items="{!v.TaskList}" var="objTask" indexVar="index">
                    <tr class="slds-hint-parent">
                        <td class="slds-cell-edit" role="gridcell">
                            <span class="slds-grid slds-grid_align-spread">
                                <span class="slds-truncate" title="Acme">
                                    <ui:outputText value="{!objTask.Subject}"/>
                                </span>
                            </span>
                        </td>
                        <td class="slds-cell-edit" role="gridcell">
                            <span class="slds-grid slds-grid_align-spread">
                                <span class="slds-truncate" title="Acme">
                                    <ui:outputDate value="{!objTask.ActivityDate}"/>
                                </span>
                            </span>
                        </td>
                        <td class="slds-cell-edit" role="gridcell">
                            <span class="slds-grid slds-grid_align-spread">
                                <span class="slds-truncate" title="Acme">
                                    <ui:outputText value="{!objTask.Owner.Name}"/>
                                </span>
                            </span>
                        </td>
                        <td class="slds-cell-edit" role="gridcell">
                            <span class="slds-grid slds-grid_align-spread">
                                <span class="slds-truncate" title="Acme">
                                    <ui:button label="Complete" class="slds-button_brand" 
                                               labelClass="{!index}"
                                               press="{!c.completeClicked}"/>
                                </span>
                            </span>
                        </td>
                        
                    </tr>
                </aura:iteration>
            </tbody>
        </table>
    </div>
    
    <lightning:spinner aura:id="mySpinner" class="slds-hide" />
</aura:component>